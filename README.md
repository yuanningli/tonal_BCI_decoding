## Overview
This repository contains scripts and files for the analysis of our work entitled “A brain-to-text framework of decoding natural tonal sentences”. The following sections provide an overview of the contents and organization.

## Contents

### Jupyter Notebooks
- **preprocessing.ipynb**: This notebook is dedicated to data preprocessing. It includes the selection of discriminative and responsive electrodes, as well as the generation of label matrices.

- **main.ipynb**: This notebook focuses on the final evaluation of the project.

- **transfers_matrix.csv**: This is external transfer matrix collected from the CCL corpus for language model purposes.

### Intermediate Files
  - All other **.npy** files are intermediate files generated by running the provided scripts.

### Model Files
  - All other **.pt** files are intermediate files for models constructed by running the provided scripts.

### Subfolders

#### Raw
- The **Raw** folder contains the original raw data, including the high-gamma band data from 256 electrodes and phonological transcription. Note that this data is not open to the public.

#### 2D_brain
- The **2D_brain** folder includes reconstructed brain surfaces and the placement of electrodes.

#### hyperopt
- The **hyperopt** folder contains Jupyter notebooks for hyperparameter tuning.

## How to Use
Please refer to the corresponding Jupyter notebooks for detailed information on how to use and execute the scripts. Ensure that you have the necessary permissions to access the raw data in the **Raw** folder.

## Contributors
- Daohan Zhang1,2,3#,
- Zhenjie Wang4#,
- Youkun Qian1,2,3#,
- Zehao Zhao1,2,3,
- Yan Liu1,2,3,
- Xiaotao Hao1,2,3,
- Wanxin Li1,2,3,
- Honglin Zhu5,
- Luyao Chen6,
- Kunyu Xu7,
- Yuanning Li4,8*,
- Junfeng Lu1,2,3,7,9*,
- Jinsong Wu1,2,3*

1.Department of Neurosurgery, Huashan Hospital, Shanghai Medical College, Fudan University, Shanghai 200040, China
2.Shanghai Key Laboratory of Brain Function Restoration and Neural Regeneration, Shanghai 200040, China
3.National Center for Neurological Disorders, Huashan Hospital, Shanghai Medical College, Fudan University, Shanghai 200040, China 
4.School of Biomedical Engineering, ShanghaiTech University, Shanghai 201210, China 
5.Faculty of Life Sciences and Medicine, King's College London, London SE1 1UL, UK
6.School of International Chinese Language Education, Beijing Normal University, Beijing 100875, China
7.Institute of Modern Languages and Linguistics, Fudan University, Shanghai 200433, China 
8.State Key Laboratory of Advanced Medical Materials and Devices, ShanghaiTech University, Shanghai 201210, China
9. MOE Frontiers Center for Brain Science, Huashan Hospital, Fudan University, Shanghai 200040, China 

# These authors contributed equally to this work.
* Corresponding authors: Jinsong Wu (wujinsong@huashan.org.cn), Junfeng Lu (junfeng_lu@fudan.edu.cn), Yuanning Li (liyn2@shanghaitech.edu.cn) 

Feel free to reach out if you have any questions or feedback!